<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>故障注入 | WEB Doc | 在线文档</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/webnote/assets/logo.png">
    <meta name="description" content="A VuePress project Create by enbo.wang.">
    <link rel="preload" href="/webnote/assets/css/0.styles.b4dff61e.css" as="style"><link rel="preload" href="/webnote/assets/js/app.24a2cd47.js" as="script"><link rel="preload" href="/webnote/assets/js/2.3d8178f3.js" as="script"><link rel="preload" href="/webnote/assets/js/34.8bebc704.js" as="script"><link rel="prefetch" href="/webnote/assets/js/10.4318cfdf.js"><link rel="prefetch" href="/webnote/assets/js/11.e5a9108b.js"><link rel="prefetch" href="/webnote/assets/js/12.c9a0038b.js"><link rel="prefetch" href="/webnote/assets/js/13.fe12fe70.js"><link rel="prefetch" href="/webnote/assets/js/14.c8165e7b.js"><link rel="prefetch" href="/webnote/assets/js/15.8ba27b65.js"><link rel="prefetch" href="/webnote/assets/js/16.bd92d356.js"><link rel="prefetch" href="/webnote/assets/js/17.c1b4e7a0.js"><link rel="prefetch" href="/webnote/assets/js/18.7d1511c8.js"><link rel="prefetch" href="/webnote/assets/js/19.9db155b6.js"><link rel="prefetch" href="/webnote/assets/js/20.06cc3d86.js"><link rel="prefetch" href="/webnote/assets/js/21.b4bc5a31.js"><link rel="prefetch" href="/webnote/assets/js/22.c742e6bc.js"><link rel="prefetch" href="/webnote/assets/js/23.2c225cc1.js"><link rel="prefetch" href="/webnote/assets/js/24.0228042c.js"><link rel="prefetch" href="/webnote/assets/js/25.da56562b.js"><link rel="prefetch" href="/webnote/assets/js/26.fa75dae9.js"><link rel="prefetch" href="/webnote/assets/js/27.7ad52951.js"><link rel="prefetch" href="/webnote/assets/js/28.5d25d675.js"><link rel="prefetch" href="/webnote/assets/js/29.3f16206b.js"><link rel="prefetch" href="/webnote/assets/js/3.6358e9be.js"><link rel="prefetch" href="/webnote/assets/js/30.f2c12df9.js"><link rel="prefetch" href="/webnote/assets/js/31.f12f3f34.js"><link rel="prefetch" href="/webnote/assets/js/32.3b5ce204.js"><link rel="prefetch" href="/webnote/assets/js/33.4dc01bc0.js"><link rel="prefetch" href="/webnote/assets/js/35.bb7fc5dc.js"><link rel="prefetch" href="/webnote/assets/js/36.30252ca2.js"><link rel="prefetch" href="/webnote/assets/js/37.6383ae8a.js"><link rel="prefetch" href="/webnote/assets/js/38.aaa0fb61.js"><link rel="prefetch" href="/webnote/assets/js/39.a88f2190.js"><link rel="prefetch" href="/webnote/assets/js/4.3219b438.js"><link rel="prefetch" href="/webnote/assets/js/40.4fa1414e.js"><link rel="prefetch" href="/webnote/assets/js/5.f8c77af5.js"><link rel="prefetch" href="/webnote/assets/js/6.1e845e5a.js"><link rel="prefetch" href="/webnote/assets/js/7.e36b2d9c.js"><link rel="prefetch" href="/webnote/assets/js/8.855cd9ed.js"><link rel="prefetch" href="/webnote/assets/js/9.394ce857.js">
    <link rel="stylesheet" href="/webnote/assets/css/0.styles.b4dff61e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/webnote/" class="router-link-active no-logo home-link"><!----> <span class="site-name">WEB Doc | 在线文档</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/webnote/" class="router-link-active">
          Home
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          前端笔记
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          后端笔记
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          工具使用
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item ant-menu-item-selected"><a href="/webnote/tech/" class="router-link-active">
          技术方案
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/webnote/doc/">
          文档编写
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <a href="https://github.com/enbo-wang/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>技术方案</span> <span class="arrow down"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/webnote/tech/" aria-current="page" title="介绍" class="sidebar-link">介绍</a></li><li><a href="/webnote/tech/混沌测试.html" title="混沌测试" class="sidebar-link">混沌测试</a></li><li><a href="/webnote/tech/故障注入.html" title="故障注入" class="active sidebar-link">故障注入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webnote/tech/故障注入.html#背景" title="背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/webnote/tech/故障注入.html#方案期望" title="方案期望" class="sidebar-link">方案期望</a></li><li class="sidebar-sub-header"><a href="/webnote/tech/故障注入.html#方案选型" title="方案选型" class="sidebar-link">方案选型</a></li><li class="sidebar-sub-header"><a href="/webnote/tech/故障注入.html#原理" title="原理" class="sidebar-link">原理</a></li><li class="sidebar-sub-header"><a href="/webnote/tech/故障注入.html#failpoint环境搭建" title="failpoint环境搭建" class="sidebar-link">failpoint环境搭建</a></li><li class="sidebar-sub-header"><a href="/webnote/tech/故障注入.html#故障注入与激活" title="故障注入与激活" class="sidebar-link">故障注入与激活</a></li><li class="sidebar-sub-header"><a href="/webnote/tech/故障注入.html#进阶-精细控制" title="进阶-精细控制" class="sidebar-link">进阶-精细控制</a></li><li class="sidebar-sub-header"><a href="/webnote/tech/故障注入.html#附录-failpoint-maker函数" title="附录: failpoint Maker函数" class="sidebar-link">附录: failpoint Maker函数</a></li></ul></li><li><a href="/webnote/tech/前端自动化.html" title="前端自动化" class="sidebar-link">前端自动化</a></li></ul></section></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="故障注入-代码级故障模拟"><a href="#故障注入-代码级故障模拟" class="header-anchor">#</a> 故障注入: 代码级故障模拟</h1> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>对于一个大型的分布式的微服务系统，模拟各个环节、各个服务调用链过程中的异常十分必要。且这些故障模拟必须做到无侵入地集成到系统中，可以手工激活这些故障观测系统表现是否符合期望。</p> <h2 id="方案期望"><a href="#方案期望" class="header-anchor">#</a> 方案期望</h2> <ul><li>功能诉求:</li></ul> <ol><li>微服务中某个服务出现随机延迟、某个服务不可用。</li> <li>存储系统磁盘 I/O 延迟增加、I/O 吞吐量过低、落盘时间长。</li> <li>调度系统中出现热点，某个调度指令失败。</li> <li>充值系统中模拟第三方重复请求充值成功回调接口。</li> <li>游戏开发中模拟玩家网络不稳定、掉帧、延迟过大等，以及各种异常输入（外挂请求）情况下系统是否正确工作。</li></ol> <ul><li>方案诉求</li></ul> <ol><li>不能影响正常功能逻辑，不能对功能代码有任何侵入</li> <li>故障注入的代码最终不能出现在最终发行的二进制文件中。</li> <li>故障注入的代码必须是易读、易写并且能引入编译器检测。</li> <li>支持并行测试，可以通过指定控制某个故障点是否激活</li></ol> <h2 id="方案选型"><a href="#方案选型" class="header-anchor">#</a> 方案选型</h2> <p>Go故障注入解决方案中有两个项目应用比较广泛 即etcd团队的gofail以及PingCap公司的failpoint
经过实际调研与体验，gofail存在一些问题，包括:</p> <ul><li>故障注入代码以注释的形式注入在代码中，编译器无法检查其语法正确性，且转换后的代码可读性基本为0；</li> <li>无法进行精确控制，开启注入后即激活所有故障点，对并行测试不友好；</li> <li>编译后的代码可能会影响代码行数，即原本在第10行的代码，转换后可能变到了第12行，对于故障排查与代码定位不优化</li></ul> <p>综上，选择更加人性化的failpoint方案；</p> <blockquote><p><code>Failpoint</code> 项目有PingCap公司开发，它是 FreeBSD failpoints 的 Golang 实现，允许在代码中注入错误或异常行为， 并由环境变量或代码动态激活来触发这些异常行为。Failpoint 能用于各种复杂系统中模拟错误处理来提高系统的容错性、正确性和稳定性；对于任何一个 Golang 代码的源文件，可以通过解析出这个文件的语法树，遍历整个语法树，找出所有 failpoint 注入点，然后对语法树重写，转换成想要的逻辑。</p></blockquote> <h2 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h2> <p>宏的本质是什么？如果追本溯源，发现其实可以通过 AST 重写在 Golang 中实现满足以上条件的 failpoint，原理如下图所示：
<img src="https://raw.githubusercontent.com/enbo-wang/PicBed/master/img/20201015113637.png" alt="20201015113637">
对于任何一个 Golang 代码的源文件，可以通过解析出这个文件的语法树，遍历整个语法树，找出所有 failpoint 注入点，然后对语法树重写，转换成想要的逻辑。
<img src="https://raw.githubusercontent.com/enbo-wang/PicBed/master/img/20201015113724.png" alt="20201015113724"></p> <h2 id="failpoint环境搭建"><a href="#failpoint环境搭建" class="header-anchor">#</a> failpoint环境搭建</h2> <div class="language- extra-class"><pre class="language-text"><code>cd $GOPATH/src

mkdir -p github.com/pingcap

cd github.com/pingcap

git clone https://github.com/pingcap/failpoint.git
 
cd failpoint

make
GO111MODULE=on CGO_ENABLED=0 GO111MODULE=on go build  -ldflags '-X &quot;github.com/pingcap/failpoint/failpoint-ctl/version.releaseVersion=12f4ac2-dev&quot; -X &quot;github.com/pingcap/failpoint/failpoint-ctl/version.buildTS=2019-11-15 09:41:49&quot; -X &quot;github.com/pingcap/failpoint/failpoint-ctl/version.gitHash=12f4ac2fd11dfc6b2f7018b00bb90f61a5b6b692&quot; -X &quot;github.com/pingcap/failpoint/failpoint-ctl/version.gitBranch=master&quot; -X &quot;github.com/pingcap/failpoint/failpoint-ctl/version.goVersion=go version go1.13 darwin/amd64&quot;' -o bin/failpoint-ctl failpoint-ctl/main.go
failpoint-ctl build successfully :-) !
</code></pre></div><p>编译后，生成可执行文件failpoint-ctl：</p> <div class="language- extra-class"><pre class="language-text"><code>ll bin
total 6840
-rwxr-xr-x  1 lanyang  staff   3.3M 11 15 17:41 failpoint-ctl
</code></pre></div><h2 id="故障注入与激活"><a href="#故障注入与激活" class="header-anchor">#</a> 故障注入与激活</h2> <h3 id="_1-注入故障代码"><a href="#_1-注入故障代码" class="header-anchor">#</a> 1.注入故障代码</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;github.com/pingcap/failpoint&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    failpoint<span class="token punctuation">.</span><span class="token function">Inject</span><span class="token punctuation">(</span><span class="token string">&quot;testPanic&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;failpoint triggerd&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-代码转换"><a href="#_2-代码转换" class="header-anchor">#</a> 2.代码转换</h3> <p>将代码转换为故障注入代码</p> <div class="language- extra-class"><pre class="language-text"><code>$GOPATH/src/github.com/pingcap/failpoint/bin/failpoint-ctl enable
</code></pre></div><p>启用后，会生成以下文件，且故障点代码进行转换
<img src="https://raw.githubusercontent.com/enbo-wang/PicBed/master/img/20201015115031.png" alt="20201015115031">
将代码还原</p> <div class="language- extra-class"><pre class="language-text"><code>$GOPATH/src/github.com/pingcap/failpoint/bin/failpoint-ctl disable
</code></pre></div><p>还原后，额外生成的文件被删除，代码还原</p> <h3 id="_3-代码执行-激活故障"><a href="#_3-代码执行-激活故障" class="header-anchor">#</a> 3.代码执行&amp;激活故障</h3> <p>正常执行</p> <div class="language- extra-class"><pre class="language-text"><code>./your-program
</code></pre></div><p>激活故障</p> <div class="language- extra-class"><pre class="language-text"><code>GO_FAILPOINTS=&quot;main/testPanic=return(true)&quot; ./your-program //可以指定要激活那些故障点
</code></pre></div><h2 id="进阶-精细控制"><a href="#进阶-精细控制" class="header-anchor">#</a> 进阶-精细控制</h2> <p>有时为了进行并行测试，即激活故障注入点不影响其他人的测试，可以通过context.Context增加一个Hook 这样就可以精细化控制failpoint；</p> <p>通过WithHook函数包装一个回调函数，通过内置一些判断逻辑可以判断是否需要命中故障点；改回调函数入参为context和故障点名称，内部可以通过context的Value判断，也可以通过其他方式判断，这里可以根据需求自行控制即可；</p> <p>demo代码如下:</p> <div class="language-go extra-class"><pre class="language-go"><code>sctx <span class="token operator">:=</span> failpoint<span class="token punctuation">.</span><span class="token function">WithHook</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> fpname <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
    <span class="token comment">//fmt.Printf(&quot;hook ctx %v,%v\n&quot;,ctx,fpname) // ctx可以省略</span>
    <span class="token comment">//return ctx.Value(fpname) != nil // Determine by ctx key</span>
    <span class="token keyword">if</span> c<span class="token punctuation">.</span>Ctx<span class="token punctuation">.</span>Request<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>RawQuery <span class="token operator">==</span> <span class="token string">&quot;mock=true&quot;</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

failpoint<span class="token punctuation">.</span><span class="token function">InjectContext</span><span class="token punctuation">(</span>sctx<span class="token punctuation">,</span><span class="token string">&quot;common_info&quot;</span><span class="token punctuation">,</span><span class="token keyword">func</span><span class="token punctuation">(</span>val failpoint<span class="token punctuation">.</span>Value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;mock error 2: %v\n&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    c<span class="token punctuation">.</span><span class="token function">ResponseSuccess</span><span class="token punctuation">(</span><span class="token string">&quot;ping mock point2&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="附录-failpoint-maker函数"><a href="#附录-failpoint-maker函数" class="header-anchor">#</a> 附录: failpoint Maker函数</h2> <h3 id="marker-函数"><a href="#marker-函数" class="header-anchor">#</a> Marker 函数</h3> <p>AST 重写阶段标记需要被重写的部分，主要有以下功能：</p> <ul><li>提示 Rewriter 重写为一个相等的 IF 语句。
<ul><li>标记函数的参数是重写过程中需要用到的参数。</li> <li>标记函数是一个空函数，编译过程会被 inline，进一步被消除。</li> <li>标记函数中注入的 failpoint 是一个闭包，如果闭包访问外部作用于变量，闭包语法允许捕获外部作用域变量，不会出现编译错误， 同时转换后的的代码是一个 IF 语句，IF  语句访问外部作用域变量不会产生任何问题，所以闭包捕获只是为了语法合法，最终不会有任何额外开销。</li></ul></li> <li>简单、易读、易写。</li> <li>引入编译器检测，如果 Marker 函数的参数不正确，程序不能通过编译的，进而保证转换后的代码正确性。</li></ul> <p>目前支持的 Marker 函数列表：</p> <div class="language- extra-class"><pre class="language-text"><code>func Inject(fpname string, fpblock func(val Value)) {}
func InjectContext(fpname string, ctx context.Context, fpblock func(val Value)) {}
func Break(label ...string) {}
func Goto(label string) {}
func Continue(label ...string) {}
func Fallthrough() {}
func Return(results ...interface{}) {}
func Label(label string) {}
</code></pre></div><p>关于其他的Maker函数的用法可以参考<a href="https://cloud.tencent.com/developer/article/1420489" target="_blank" rel="noopener noreferrer">&quot;PingCap官方文档&quot;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/15/2020, 12:11:05 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/webnote/tech/混沌测试.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        混沌测试
      </a></span> <span class="next"><a href="/webnote/tech/前端自动化.html">
        前端自动化
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/webnote/assets/js/app.24a2cd47.js" defer></script><script src="/webnote/assets/js/2.3d8178f3.js" defer></script><script src="/webnote/assets/js/34.8bebc704.js" defer></script>
  </body>
</html>